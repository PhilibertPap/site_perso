// js/app.js

console.log("app.js chargé");

const routes = {
  accueil:  'templates/accueil.tpl.html',
  projets:  'templates/projets.tpl.html',
  cv:       'templates/cv.tpl.html',
  hobbies:  'templates/hobbies.tpl.html',
  cours:    'templates/cours.tpl.html'   // guillemet ajouté ici
};

function getData() {
  return {
    nom: "Philibert Pappens",
    projets: [
      {
        titre: "Analyse structurelle du gréement d’un voilier",
        contexte: "Projet de recherche – École polytechnique",
        description: "Étude du comportement du gréement et du mât, dimensionnement et analyse de stabilité.",
        date: "Septembre 2025 – Décembre 2025"
      },
      {
        titre: "Solution au problème d'isomorphisme de graphes",
        contexte: "Projet scientifique collectif – École polytechnique",
        description: "Implémentation et étude d’algorithmes pour l’isomorphisme de graphes.",
        date: "Septembre 2024 – Avril 2025"
      }
    ],
    cours: [
      {
        categorie: "Mécanique",
        elements: [
          {
            titre: "Mécanique des milieux continus",
            description: "Bases du comportement des matériaux, formulation locale/faible."
          },
          {
            titre: "Mécanique des structures et flambement",
            description: "Poutres, plaques, stabilité et post‑flambement."
          },
          {
            titre: "Mécanique des matériaux",
            description: "Comportement élasto‑plastique, endommagement (intro)."
          }
        ]
      },
      {
        categorie: "Méthodes numériques / Calcul scientifique",
        elements: [
          {
            titre: "Méthodes numériques pour l’ingénieur",
            description: "Schémas d’approximation, erreurs, stabilité."
          },
          {
            titre: "Éléments finis",
            description: "Formulation variationnelle, espaces d’approximation, assemblage."
          },
          {
            titre: "Simulation numérique avancée",
            description: "Problèmes couplés et non linéaires (projets)."
          }
        ]
      },
      {
        categorie: "Autres domaines",
        elements: [
          {
            titre: "Probabilités / statistiques",
            description: "Outils pour l’analyse de données et la fiabilité."
          },
          {
            titre: "Informatique scientifique",
            description: "Python, structures de données, algorithmes."
          }
        ]
      }
    ],
    interets: [
      {
        titre: "Football",
        sous_titre: "Gardien de but",        image: "images/hobbies/football.jpeg",        paragraphes: [
          "Je joue au football depuis le collège, essentiellement au poste de gardien de but.",
          "À l’École polytechnique, je suis gardien depuis deux ans. Nous avons deux créneaux d’entraînement par semaine (un en troisième année), ainsi que des matchs en championnat universitaire le jeudi.",
          "Avant cela, j’ai joué deux ans en club au collège et deux ans avec l'équipe de ma prépa."
        ],
        liens: []
      },
      {
        titre: "Scoutisme marin",
        sous_titre: "Troupe Saint François-Xavier (Paris VI)",
        image: "images/hobbies/voile_scout.jpeg",
        paragraphes: [
          "J’ai commencé le scoutisme à la troupe Vé Brest marine, avec un premier camp d’été et deux années de troupe.",
          "Je suis actuellement assistant chef de troupe à la SUF Saint François-Xavier à Notre-Dame-des-Champs (Paris VI).",
          "J’ai participé à un camp d’été en 2024, un autre en 2025 et je préparerai mon dernier camp en 2026.",
          "La particularité de ces groupes est d’être des scouts marins : les camps comprennent une partie voile, en plus des activités scoutes habituelles.",
          "Je suis titulaire du CEP1 et du PSC1."
        ],
        liens: []
      },
      {
        titre: "Orgue",
        sous_titre: "Formation au conservatoire et en cours particuliers",
        paragraphes: [
          "J’ai commencé l’orgue au conservatoire pendant le primaire, puis j’ai poursuivi tout le collège avec un professeur particulier.",
          "Au lycée, j’ai continué une année avec un professeur particulier, organiste dans une église.",
          "Je suis particulièrement attaché à la musique de Bach"
        ],
        liens: [
          {
            url: "https://www.youtube.com/watch?v=a_pJjg6qUXk&list=RDa_pJjg6qUXk&start_radio=1",
            texte: "Une interprétation des petits préludes et fugues de Bach"
          }
        ]
      },
      {
        titre: "Piano",
        sous_titre: "Cours particuliers",
        paragraphes: [
          "J’ai pris un an de cours particuliers de piano au lycée.",
          "Même si je ne joue pas à un niveau avancé, j’apprécie beaucoup le répertoire pour piano.",
          "En particulier, j’aime beaucoup Bach, mais également Chopin, Beethoven, Mozart ..."
        ],
        liens: [
          {
            url: "https://www.youtube.com/watch?v=NLF-OpGH-u4&list=RDNLF-OpGH-u4&start_radio=1",
            texte: "Le concerto pour clavier n°1 de Bach, interprété par Glenn Gould"
          }
        ]
      },
      {
        titre: "Chant choral",
        sous_titre: "Ensemble Vocal de l’École polytechnique",        image: "images/hobbies/concert_chorale.jpeg",        paragraphes: [
          "Je fais partie de l’Ensemble Vocal de l’École polytechnique depuis deux ans.",
          "J’ai été responsable de la communication pendant une année : réalisation des affiches, gestion du site web et des comptes Instagram / Facebook, préparation des concerts avec le bureau.",
          "La chorale fait partie des activités qui structurent mon année à l’école, autant sur le plan musical que collectif."
        ],
        liens: [
            {
            url: "https://www.instagram.com/chorale_x/",
            texte: "Le compte Instagram de l'Ensemble Vocal"
          }
        ]
        }
    ]
  };
}

function loadPage(page) {
  const path = routes[page] || routes.accueil;
  console.log("loadPage", page, "=>", path);

  $.ajax({
    url: path,
    method: 'GET',
    dataType: 'text'
  })
  .done(function (templateText) {
    console.log("template chargé, longueur =", templateText.length);
    const data = getData();
    const rendered = Mustache.render(templateText, data);
    $("#content").html(rendered);
  })
  .fail(function (err) {
    console.error("Erreur chargement template", path, err);
    $("#content").html("<p class='text-danger'>Erreur de chargement du template.</p>");
  });
}

$(function () {
  console.log("DOM prêt");
  loadPage("accueil");

  function goTo(page) {
    loadPage(page);
    $(".nav-link").removeClass("active");
    $('.nav-link[data-page="' + page + '"]').addClass("active");
  }

  $(".nav-link, .navbar-brand").on("click", function (e) {
    e.preventDefault();
    const page = $(this).data("page");
    console.log("click nav sur", page);
    goTo(page);
  });

  $(document).on("click", ".js-nav", function (e) {
    e.preventDefault();
    const page = $(this).data("page");
    console.log("click bouton sur", page);
    goTo(page);
  });
  
  // Active le lien de navigation correspondant
  $(document).on('pageLoaded', function(event, page) {
    $('.nav-link').removeClass('active');
    $('.nav-link[data-page="' + page + '"]').addClass('active');
  });
});
